---
- name: Targets is set
  ansible.builtin.assert:
    that: targets is defined
    fail_msg: "'targets' must be set"

- name: Check targets is empty
  ansible.builtin.set_fact:
    no_targets: "{{ true if not targets }}"
  when: targets is defined

- name: Targets contains at least one installation target
  ansible.builtin.assert:
    that: no_targets != true
    fail_msg: "Targets must contain at least one installation target"

- name: Validate targets
  ansible.builtin.assert:
    that:
      - target_name_map[item] is defined
    quiet: true
  loop: "{{ targets }}"

- name: Validate other role vars
  ansible.builtin.assert:
    that:
      - verbosity is not defined or verbosity in ("debug","trace")
      - install_timeout_seconds is not defined or install_timeout_seconds is integer
    quiet: true


